name: Benchmark

on:
  push:
  workflow_dispatch:
  schedule:
# Every Friday at 22:30 - rerun pipeline to check for dependency-based issues
    - cron: '30 22 * * 5'

jobs:
  BenchmarkingParams:
    uses: pyTooling/Actions/.github/workflows/Parameters.yml@r1
    with:
      name: Benchmark
      python_version_list: "3.11 3.12 pypy-3.10"

  Benchmarking:
    uses: pyTooling/Actions/.github/workflows/UnitTesting.yml@dev
    needs:
      - BenchmarkingParams
    with:
      jobs: ${{ needs.BenchmarkingParams.outputs.python_jobs }}
      requirements: '-r tests/benchmark/requirements.txt'
#      unittest_xml_artifact: ${{ fromJson(needs.BenchmarkingParams.outputs.artifact_names).unittesting_xml }}
      unittest_directory: 'benchmark'

  PublishTestResults:
    uses: pyTooling/Actions/.github/workflows/PublishTestResults.yml@dev
    needs:
      - Benchmarking
    with:
      merged_junit_artifact: ${{ fromJson(needs.UnitTestingParams.outputs.artifact_names).unittesting_xml }}
